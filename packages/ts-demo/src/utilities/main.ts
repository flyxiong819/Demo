import { CHANNEL_LIST } from './channel';
import * as Excel from 'exceljs';


/** 当前全量fps channel id */
const fpsChannelIds = [
  '50001030000',
  '50001040000',
  '50001050000',
  '50001050100',
  '50001050200',
  '50001050300',
  '50001050400',
  '50001050500',
  '50001050600',
  '50001050700',
  '50001050800',
  '50001050900',
  '50001060000',
  '50001070000',
  '50001080000',
  '50001080100',
  '50001080200',
  '50001080300',
  '50001080400',
  '50001080500',
  '50001080600',
  '50001080700',
  '50001080800',
  '50001080900',
  '50001081000',
  '50001081100',
  '50001081200',
  '50001081300',
  '50001081400',
  '50001081500',
  '50001081600',
  '50001081700',
  '50001081800',
  '50001081900',
  '50001082000',
  '50001082100',
  '50001082200',
  '50001082300',
  '50001082400',
  '50001082500',
  '50001082600',
  '50001082700',
  '50001082800',
  '50001082900',
  '50001083000',
  '50001083100',
  '50001090000',
  '50001100000',
  '50001100100',
  '50001100200',
  '50001100300',
  '50001100400',
  '50001110000',
  '50001120000',
  '50001130000',
  '50001140000',
  '50001083200',
  '50001083300',
  '50001083400',
  '50001083500',
  '50001083600',
  '50001083700',
  '50001083800',
  '50001083900',
  '50001084000',
  '50001084100',
  '50001084200',
  '50001084300',
  '50001084400',
  '50001084500',
  '50001084600',
  '50001084700',
  '50001084800',
  '50001084900',
  '50001085000',
  '50001085100',
  '50001085200',
  '50001085300',
  '50001085400',
  '50001085500',
  '50001085600',
  '50001150000',
  '50001160000',
  '50001170000',
  '50001180000',
  '50001190000',
  '50001200000',
  '50001210000',
  '50001220000',
  '50001230000',
  '50001240000',
  '50001250000',
  '50001260000',
];

let countYes = 0;
let countNo = 0;
// 根据id去获取描述文案
const info = fpsChannelIds.map((channelId: string) => {
  const item = CHANNEL_LIST[channelId];
  if (item) {
    countYes++;
    return {
      channelId, 
      'desc_zh-cn': item.name,
      'desc_zh-hk': item.name1,
      'desc_en': item.name2,
    };
  } else {
    countNo++;
    return [channelId, '', '', ''];
  }
});



const workbook = new Excel.Workbook();
const sheet = workbook.addWorksheet('sheet');

const columns = [
  {
    header: '渠道Id',
    key: 'channelId',
    width: 50,
  },
  {
    header: '简体',
    key: 'desc_zh-cn',
    width: 60,
  },
  {
    header: '繁体',
    key: 'desc_zh-hk',
    width: 60,
  },
  {
    header: '英文',
    key: 'desc_en',
    width: 60,
  },
];

sheet.columns = columns;
sheet.addRows(info);
workbook.xlsx.writeFile('./fps-channel-ids.xlsx');

console.log('countYes', countYes);
console.log('countNo', countNo);
